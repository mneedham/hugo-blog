+++
draft = true
date="2022-06-07 02:44:37"
title="Flask: Catch all and delegate route"
tag=['pinot']
category=['pinot']
description="In this post we'll learn how to work out a problem when trying to import files with the same name into Apache Pinot."
image="uploads/2022/03/no-import-banner.png"
+++


Can only have one route that captures everything, then multiplex from there

[source, python]
----
@app.route('/', defaults={'path': ''})
@app.route('/<path:path>')
@authorization_guard
def catch_all(path):
  return {
    "currentTime": datetime.datetime.now(),
    "currentTime_": datetime.datetime.now(),
    "path": path
  }
----


.api/tournaments.py
[source, python]
----
from flask import Flask, jsonify

app = Flask(__name__)


@app.route('/', defaults={'path': ''})
@app.route('/<path:path>')
def tournaments(path):
  return jsonify([{
    "name": "Australian Open 2022"
  },
  {
    "name": "French Open 2022"
  }])
----

.vercel.json
[source, json]
----
{
    "rewrites": [
        {
            "source": "/api/tournaments/(.*)",
            "destination": "api/tournaments.py"
        },
        {
            "source": "/api/(.*)",
            "destination": "api/index.py"
        }
    ]
}
----

https://stackoverflow.com/questions/14023864/flask-url-route-route-all-other-urls-to-some-function