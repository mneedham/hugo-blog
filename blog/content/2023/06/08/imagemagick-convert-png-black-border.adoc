+++
draft = true
date="2023-06-07 02:44:37"
title="DuckDB/SQL: Pivot - 0 if null"
tag=['duckdb', 'sql', 'til']
category=['TIL']
description="In this post we'll learn how to replace null values when using the PIVOT function in DuckDB."
image="uploads/2023/06/duckdb-pivot-nulls.png"
+++

[source, bash]
----
convert -density 1000 light-logo-me.svg light-logo-me.png
----


[source, xml]
----
<svg width="140" height="48" viewBox="0 0 140 48" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M14.9309 18.0638C14.9309 22.013 11.5161 23.9146 7.62862 23.9146C3.9962 23.9146 1.30547 22.3785 0 19.5632L4.06896 17.2591C4.57742 18.7609 5.81276 19.637 7.62862 19.637C9.12067 19.637 10.1353 19.1251 10.1353 18.0645C10.1335 15.3937 0.762835 16.8574 0.762835 10.4214C0.762835 6.69184 3.92345 4.60754 7.66349 4.60754C10.606 4.60754 13.1486 5.96042 14.5641 8.48345L10.5681 10.6773C10.0228 9.50713 9.00575 8.81264 7.66169 8.81264C6.49912 8.81264 5.5548 9.32441 5.5548 10.3145C5.55852 13.0158 14.9309 11.3357 14.9309 18.0638Z" fill="#1985A1"/>
<path d="M48.1064 5.11932V23.4034H43.4201V21.2452C42.1147 22.8902 40.1508 23.9146 37.4986 23.9146C32.6669 23.9146 28.6707 19.7089 28.6707 14.2611C28.6707 8.81319 32.6669 4.60754 37.4986 4.60754C40.1508 4.60754 42.1122 5.63123 43.4201 7.27705V5.11932H48.1064ZM43.4201 14.2611C43.4201 11.1892 41.2766 9.10477 38.3702 9.10477C35.5005 9.10477 33.3569 11.1892 33.3569 14.2611C33.3569 17.3329 35.498 19.4167 38.3702 19.4167C41.2798 19.4167 43.4201 17.3335 43.4201 14.2611Z" fill="#1985A1"/>
<path d="M60.925 4.75568V10.0208C58.4911 9.72857 55.4031 10.8256 55.4031 14.6652V23.4032H50.7145V5.11932H55.4006V8.26367C56.3451 5.77757 58.634 4.75568 60.925 4.75568Z" fill="#1985A1"/>
<path d="M84.2381 9.65353V17.259C84.2381 19.2339 85.6549 19.2703 88.3412 19.1245V23.4033C81.7656 24.1348 79.5499 22.1969 79.5499 17.2602V9.65353H76.3893V5.11937H79.5499V0H84.2381V5.11937H88.3412V9.65353H84.2381Z" fill="#1985A1"/>
<path d="M100.504 4.75568V10.0208C98.07 9.72857 94.982 10.8256 94.982 14.6652V23.4032H90.2959V5.11932H94.982V8.26367C95.9258 5.77757 98.2149 4.75568 100.504 4.75568Z" fill="#1985A1"/>
<path d="M111.151 19.6363C112.968 19.6363 114.421 18.8685 115.22 17.8079L118.998 20.0018C117.291 22.4886 114.566 23.9146 111.079 23.9146C104.976 23.9146 101.125 19.7089 101.125 14.2611C101.125 8.81319 105.012 4.60754 110.716 4.60754C116.092 4.60754 119.907 8.88581 119.907 14.2611C119.904 14.9119 119.843 15.561 119.725 16.201H106.029C106.681 18.6126 108.681 19.6363 111.151 19.6363ZM115.22 12.5421C114.639 9.90949 112.677 8.85012 110.716 8.85012C108.209 8.85012 106.501 10.203 105.957 12.5421H115.22Z" fill="#1985A1"/>
<path d="M131.205 19.6363C133.021 19.6363 134.473 18.8685 135.272 17.8079L139.051 20.0018C137.343 22.4886 134.619 23.9146 131.132 23.9146C125.029 23.9146 121.177 19.7089 121.177 14.2611C121.177 8.81319 125.064 4.60754 130.768 4.60754C136.144 4.60754 139.959 8.88581 139.959 14.2611C139.956 14.9119 139.895 15.561 139.778 16.201H126.081C126.736 18.6126 128.734 19.6363 131.205 19.6363ZM135.272 12.5421C134.692 9.90949 132.73 8.85012 130.768 8.85012C128.261 8.85012 126.554 10.203 126.01 12.5421H135.272Z" fill="#1985A1"/>
<path d="M23.658 9.65353V17.259C23.658 19.2339 25.0749 19.2703 27.7612 19.1245V23.4033C21.1856 24.1348 18.9693 22.1969 18.9693 17.2602V9.65353H15.8112V5.11937H18.9711V0H23.658V5.11937H27.7612V9.65353H23.658Z" fill="#1985A1"/>
<path d="M74.4982 12.3863H69.0722L69.0691 4.95296C69.0692 4.87786 69.045 4.80469 68.9999 4.74489C68.9548 4.68495 68.8916 4.64154 68.8197 4.62129C68.7479 4.60103 68.6714 4.60517 68.6019 4.63286C68.5326 4.66056 68.4742 4.7103 68.4356 4.77465L62.044 15.4838C62.0126 15.5361 61.9953 15.5957 61.9944 15.6568C61.9933 15.7178 62.0083 15.778 62.0381 15.8313C62.0677 15.8847 62.1108 15.929 62.1632 15.9601C62.2154 15.9909 62.2749 16.0075 62.3356 16.0076H67.7636L67.7679 23.441C67.7675 23.5162 67.7916 23.5894 67.8365 23.6494C67.8816 23.7095 67.9448 23.7529 68.0167 23.7732C68.0887 23.7934 68.1653 23.7894 68.2346 23.7616C68.304 23.7338 68.3623 23.6838 68.4008 23.6193L74.7885 12.9101C74.8198 12.858 74.8368 12.7985 74.8379 12.7376C74.8388 12.6767 74.8238 12.6166 74.7943 12.5634C74.765 12.5102 74.722 12.4658 74.67 12.4348C74.6179 12.4037 74.5587 12.387 74.4982 12.3863Z" fill="#1985A1"/>
<path d="M1.64801 46.3752V33.7462H6.73541C8.22829 33.7462 9.48815 34.0031 10.5151 34.5165C11.5423 35.0181 12.3185 35.7407 12.8439 36.684C13.3813 37.6155 13.65 38.7382 13.65 40.0518C13.65 41.3535 13.3813 42.4761 12.8439 43.4195C12.3185 44.363 11.5423 45.0915 10.5151 45.6049C9.48815 46.1185 8.22829 46.3752 6.73541 46.3752H1.64801ZM4.96199 43.6882H6.52045C7.8222 43.6882 8.7836 43.3897 9.40451 42.7925C10.0375 42.1954 10.3539 41.2819 10.3539 40.0518C10.3539 38.8098 10.0375 37.8962 9.40451 37.311C8.7836 36.7139 7.8222 36.4153 6.52045 36.4153H4.96199V43.6882ZM19.4047 46.3752V33.7462H28.4689V36.272H22.5754V38.6903H28.039V41.234H22.5754V43.8315H28.4689V46.3752H19.4047ZM38.2047 46.3752L32.4724 33.7462H36.0192L40.1035 43.3478H39.1183L43.1846 33.7462H46.6061L40.8738 46.3752H38.2047ZM51.1744 46.3752V33.7462H60.2385V36.272H54.3451V38.6903H59.8086V41.234H54.3451V43.8315H60.2385V46.3752H51.1744ZM65.7297 46.3752V33.7462H69.0437V43.6344H74.4535V46.3752H65.7297ZM78.8076 40.0518C78.8076 38.7382 79.0643 37.5976 79.5778 36.6303C80.0914 35.6511 80.8258 34.8927 81.7812 34.3553C82.7365 33.8179 83.8651 33.5492 85.1668 33.5492C86.4804 33.5492 87.615 33.8179 88.5704 34.3553C89.5257 34.8927 90.2601 35.6511 90.7737 36.6303C91.2991 37.5976 91.5619 38.7382 91.5619 40.0518C91.5619 41.3535 91.2991 42.494 90.7737 43.4732C90.2601 44.4525 89.5257 45.2169 88.5704 45.7661C87.615 46.3035 86.4804 46.5722 85.1668 46.5722C83.8651 46.5722 82.7365 46.3035 81.7812 45.7661C80.8377 45.2169 80.1032 44.4525 79.5778 43.4732C79.0643 42.494 78.8076 41.3535 78.8076 40.0518ZM82.2648 40.0518C82.2648 41.234 82.5036 42.1596 82.9814 42.8283C83.4591 43.4852 84.1875 43.8136 85.1668 43.8136C86.1461 43.8136 86.8806 43.4852 87.3702 42.8283C87.8597 42.1596 88.1046 41.234 88.1046 40.0518C88.1046 38.8695 87.8597 37.95 87.3702 37.2931C86.8806 36.6364 86.1461 36.3079 85.1668 36.3079C84.1875 36.3079 83.4591 36.6364 82.9814 37.2931C82.5036 37.938 82.2648 38.8576 82.2648 40.0518ZM97.3068 46.3752V33.7462H103.505C104.962 33.7462 106.061 34.1045 106.801 34.821C107.541 35.5257 107.912 36.487 107.912 37.7051C107.912 38.9114 107.541 39.8726 106.801 40.5892C106.061 41.3057 104.962 41.664 103.505 41.664H100.621V46.3752H97.3068ZM100.621 39.1203H103.075C103.636 39.1203 104.054 39.0009 104.329 38.762C104.604 38.5112 104.741 38.159 104.741 37.7051C104.741 37.2513 104.604 36.899 104.329 36.6482C104.054 36.3974 103.636 36.272 103.075 36.272H100.621V39.1203ZM113.314 46.3752V33.7462H122.378V36.272H116.485V38.6903H121.949V41.234H116.485V43.8315H122.378V46.3752H113.314ZM127.87 46.3752V33.7462H133.835C135.291 33.7462 136.415 34.0927 137.203 34.7852C138.002 35.4779 138.403 36.4393 138.403 37.6693C138.403 38.4933 138.224 39.198 137.866 39.7831C137.507 40.3563 136.988 40.8041 136.307 41.1266C135.626 41.4371 134.813 41.5923 133.871 41.5923L134.032 41.1445H134.928C135.453 41.1445 135.918 41.2878 136.325 41.5744C136.73 41.861 137.065 42.2612 137.328 42.7746L139.245 46.3752H135.626L133.566 42.3447C133.434 42.082 133.237 41.9029 132.975 41.8073C132.724 41.7118 132.438 41.664 132.115 41.664H131.184V46.3752H127.87ZM131.184 39.3173H133.262C133.907 39.3173 134.396 39.1919 134.731 38.9411C135.064 38.6785 135.232 38.2903 135.232 37.7768C135.232 37.2752 135.064 36.899 134.731 36.6482C134.396 36.3974 133.907 36.272 133.262 36.272H131.184V39.3173Z" fill="#1985A1"/>
</svg>

----

[source, xml]
----
<svg width="160" height="68" viewBox="-10 -10 160 68" fill="none" xmlns="http://www.w3.org/2000/svg">
<path d="M14.9309 18.0638C14.9309 22.013 11.5161 23.9146 7.62862 23.9146C3.9962 23.9146 1.30547 22.3785 0 19.5632L4.06896 17.2591C4.57742 18.7609 5.81276 19.637 7.62862 19.637C9.12067 19.637 10.1353 19.1251 10.1353 18.0645C10.1335 15.3937 0.762835 16.8574 0.762835 10.4214C0.762835 6.69184 3.92345 4.60754 7.66349 4.60754C10.606 4.60754 13.1486 5.96042 14.5641 8.48345L10.5681 10.6773C10.0228 9.50713 9.00575 8.81264 7.66169 8.81264C6.49912 8.81264 5.5548 9.32441 5.5548 10.3145C5.55852 13.0158 14.9309 11.3357 14.9309 18.0638Z" fill="#1985A1"/>
<path d="M48.1064 5.11932V23.4034H43.4201V21.2452C42.1147 22.8902 40.1508 23.9146 37.4986 23.9146C32.6669 23.9146 28.6707 19.7089 28.6707 14.2611C28.6707 8.81319 32.6669 4.60754 37.4986 4.60754C40.1508 4.60754 42.1122 5.63123 43.4201 7.27705V5.11932H48.1064ZM43.4201 14.2611C43.4201 11.1892 41.2766 9.10477 38.3702 9.10477C35.5005 9.10477 33.3569 11.1892 33.3569 14.2611C33.3569 17.3329 35.498 19.4167 38.3702 19.4167C41.2798 19.4167 43.4201 17.3335 43.4201 14.2611Z" fill="#1985A1"/>
<path d="M60.925 4.75568V10.0208C58.4911 9.72857 55.4031 10.8256 55.4031 14.6652V23.4032H50.7145V5.11932H55.4006V8.26367C56.3451 5.77757 58.634 4.75568 60.925 4.75568Z" fill="#1985A1"/>
<path d="M84.2381 9.65353V17.259C84.2381 19.2339 85.6549 19.2703 88.3412 19.1245V23.4033C81.7656 24.1348 79.5499 22.1969 79.5499 17.2602V9.65353H76.3893V5.11937H79.5499V0H84.2381V5.11937H88.3412V9.65353H84.2381Z" fill="#1985A1"/>
<path d="M100.504 4.75568V10.0208C98.07 9.72857 94.982 10.8256 94.982 14.6652V23.4032H90.2959V5.11932H94.982V8.26367C95.9258 5.77757 98.2149 4.75568 100.504 4.75568Z" fill="#1985A1"/>
<path d="M111.151 19.6363C112.968 19.6363 114.421 18.8685 115.22 17.8079L118.998 20.0018C117.291 22.4886 114.566 23.9146 111.079 23.9146C104.976 23.9146 101.125 19.7089 101.125 14.2611C101.125 8.81319 105.012 4.60754 110.716 4.60754C116.092 4.60754 119.907 8.88581 119.907 14.2611C119.904 14.9119 119.843 15.561 119.725 16.201H106.029C106.681 18.6126 108.681 19.6363 111.151 19.6363ZM115.22 12.5421C114.639 9.90949 112.677 8.85012 110.716 8.85012C108.209 8.85012 106.501 10.203 105.957 12.5421H115.22Z" fill="#1985A1"/>
<path d="M131.205 19.6363C133.021 19.6363 134.473 18.8685 135.272 17.8079L139.051 20.0018C137.343 22.4886 134.619 23.9146 131.132 23.9146C125.029 23.9146 121.177 19.7089 121.177 14.2611C121.177 8.81319 125.064 4.60754 130.768 4.60754C136.144 4.60754 139.959 8.88581 139.959 14.2611C139.956 14.9119 139.895 15.561 139.778 16.201H126.081C126.736 18.6126 128.734 19.6363 131.205 19.6363ZM135.272 12.5421C134.692 9.90949 132.73 8.85012 130.768 8.85012C128.261 8.85012 126.554 10.203 126.01 12.5421H135.272Z" fill="#1985A1"/>
<path d="M23.658 9.65353V17.259C23.658 19.2339 25.0749 19.2703 27.7612 19.1245V23.4033C21.1856 24.1348 18.9693 22.1969 18.9693 17.2602V9.65353H15.8112V5.11937H18.9711V0H23.658V5.11937H27.7612V9.65353H23.658Z" fill="#1985A1"/>
<path d="M74.4982 12.3863H69.0722L69.0691 4.95296C69.0692 4.87786 69.045 4.80469 68.9999 4.74489C68.9548 4.68495 68.8916 4.64154 68.8197 4.62129C68.7479 4.60103 68.6714 4.60517 68.6019 4.63286C68.5326 4.66056 68.4742 4.7103 68.4356 4.77465L62.044 15.4838C62.0126 15.5361 61.9953 15.5957 61.9944 15.6568C61.9933 15.7178 62.0083 15.778 62.0381 15.8313C62.0677 15.8847 62.1108 15.929 62.1632 15.9601C62.2154 15.9909 62.2749 16.0075 62.3356 16.0076H67.7636L67.7679 23.441C67.7675 23.5162 67.7916 23.5894 67.8365 23.6494C67.8816 23.7095 67.9448 23.7529 68.0167 23.7732C68.0887 23.7934 68.1653 23.7894 68.2346 23.7616C68.304 23.7338 68.3623 23.6838 68.4008 23.6193L74.7885 12.9101C74.8198 12.858 74.8368 12.7985 74.8379 12.7376C74.8388 12.6767 74.8238 12.6166 74.7943 12.5634C74.765 12.5102 74.722 12.4658 74.67 12.4348C74.6179 12.4037 74.5587 12.387 74.4982 12.3863Z" fill="#1985A1"/>
<path d="M1.64801 46.3752V33.7462H6.73541C8.22829 33.7462 9.48815 34.0031 10.5151 34.5165C11.5423 35.0181 12.3185 35.7407 12.8439 36.684C13.3813 37.6155 13.65 38.7382 13.65 40.0518C13.65 41.3535 13.3813 42.4761 12.8439 43.4195C12.3185 44.363 11.5423 45.0915 10.5151 45.6049C9.48815 46.1185 8.22829 46.3752 6.73541 46.3752H1.64801ZM4.96199 43.6882H6.52045C7.8222 43.6882 8.7836 43.3897 9.40451 42.7925C10.0375 42.1954 10.3539 41.2819 10.3539 40.0518C10.3539 38.8098 10.0375 37.8962 9.40451 37.311C8.7836 36.7139 7.8222 36.4153 6.52045 36.4153H4.96199V43.6882ZM19.4047 46.3752V33.7462H28.4689V36.272H22.5754V38.6903H28.039V41.234H22.5754V43.8315H28.4689V46.3752H19.4047ZM38.2047 46.3752L32.4724 33.7462H36.0192L40.1035 43.3478H39.1183L43.1846 33.7462H46.6061L40.8738 46.3752H38.2047ZM51.1744 46.3752V33.7462H60.2385V36.272H54.3451V38.6903H59.8086V41.234H54.3451V43.8315H60.2385V46.3752H51.1744ZM65.7297 46.3752V33.7462H69.0437V43.6344H74.4535V46.3752H65.7297ZM78.8076 40.0518C78.8076 38.7382 79.0643 37.5976 79.5778 36.6303C80.0914 35.6511 80.8258 34.8927 81.7812 34.3553C82.7365 33.8179 83.8651 33.5492 85.1668 33.5492C86.4804 33.5492 87.615 33.8179 88.5704 34.3553C89.5257 34.8927 90.2601 35.6511 90.7737 36.6303C91.2991 37.5976 91.5619 38.7382 91.5619 40.0518C91.5619 41.3535 91.2991 42.494 90.7737 43.4732C90.2601 44.4525 89.5257 45.2169 88.5704 45.7661C87.615 46.3035 86.4804 46.5722 85.1668 46.5722C83.8651 46.5722 82.7365 46.3035 81.7812 45.7661C80.8377 45.2169 80.1032 44.4525 79.5778 43.4732C79.0643 42.494 78.8076 41.3535 78.8076 40.0518ZM82.2648 40.0518C82.2648 41.234 82.5036 42.1596 82.9814 42.8283C83.4591 43.4852 84.1875 43.8136 85.1668 43.8136C86.1461 43.8136 86.8806 43.4852 87.3702 42.8283C87.8597 42.1596 88.1046 41.234 88.1046 40.0518C88.1046 38.8695 87.8597 37.95 87.3702 37.2931C86.8806 36.6364 86.1461 36.3079 85.1668 36.3079C84.1875 36.3079 83.4591 36.6364 82.9814 37.2931C82.5036 37.938 82.2648 38.8576 82.2648 40.0518ZM97.3068 46.3752V33.7462H103.505C104.962 33.7462 106.061 34.1045 106.801 34.821C107.541 35.5257 107.912 36.487 107.912 37.7051C107.912 38.9114 107.541 39.8726 106.801 40.5892C106.061 41.3057 104.962 41.664 103.505 41.664H100.621V46.3752H97.3068ZM100.621 39.1203H103.075C103.636 39.1203 104.054 39.0009 104.329 38.762C104.604 38.5112 104.741 38.159 104.741 37.7051C104.741 37.2513 104.604 36.899 104.329 36.6482C104.054 36.3974 103.636 36.272 103.075 36.272H100.621V39.1203ZM113.314 46.3752V33.7462H122.378V36.272H116.485V38.6903H121.949V41.234H116.485V43.8315H122.378V46.3752H113.314ZM127.87 46.3752V33.7462H133.835C135.291 33.7462 136.415 34.0927 137.203 34.7852C138.002 35.4779 138.403 36.4393 138.403 37.6693C138.403 38.4933 138.224 39.198 137.866 39.7831C137.507 40.3563 136.988 40.8041 136.307 41.1266C135.626 41.4371 134.813 41.5923 133.871 41.5923L134.032 41.1445H134.928C135.453 41.1445 135.918 41.2878 136.325 41.5744C136.73 41.861 137.065 42.2612 137.328 42.7746L139.245 46.3752H135.626L133.566 42.3447C133.434 42.082 133.237 41.9029 132.975 41.8073C132.724 41.7118 132.438 41.664 132.115 41.664H131.184V46.3752H127.87ZM131.184 39.3173H133.262C133.907 39.3173 134.396 39.1919 134.731 38.9411C135.064 38.6785 135.232 38.2903 135.232 37.7768C135.232 37.2752 135.064 36.899 134.731 36.6482C134.396 36.3974 133.907 36.272 133.262 36.272H131.184V39.3173Z" fill="#1985A1"/>
</svg>
----